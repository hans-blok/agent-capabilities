founding-hypothesis-to-cdm-workflow:
  stage: agent
  image: python:3.11
  rules:
  - if: $CI_PIPELINE_SOURCE == "web"
  script:
  - pip install -r requirements.txt
  - 'echo "=== Stap 1: Founding Hypothesis genereren ==="'
  - python agent-componenten/runners/a.founding-hypothesis-owner.py \
  - '  --input ${{ inputs.business_case }} \'
  - '  --output output/founding-hypothesis.md'
  - ''
  - "echo \"\xE2\u0153\u201C Founding hypothesis gegenereerd\""
  - 'echo "=== Stap 2: CDM genereren vanuit founding hypothesis ==="'
  - python agent-componenten/runners/b.cdm-architect.py \
  - '  --input output/founding-hypothesis.md \'
  - '  --output output/cdm.md'
  - ''
  - "echo \"\xE2\u0153\u201C CDM gegenereerd\""
  - echo "=== Workflow voltooid ==="
  - 'echo "1. Founding Hypothesis: output/founding-hypothesis.md"'
  - 'echo "2. CDM: output/cdm.md"'
  - ls -lh output/
  artifacts:
    name: founding-to-cdm-workflow
    paths:
    - output/
  after_script:
  - 'if [ $CI_JOB_STATUS == ''failed'' ]; then apk add --no-cache curl; curl -X POST
    -H ''Content-type: application/json'' --data ''{"text":"Founding-to-CDM workflow
    failed"}'' $SLACK_WEBHOOK_URL; fi'
